var watermarkObj=function(t){"use strict";function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var r=function(t,e){var n=null;n=t?document.querySelector(t):document.body;var r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return!!r&&(new r(e).observe(n,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),!0)},i={id:"wm_div_id",text:"测试水印",transparency:.15,fontSize:16,parentLeft:0,parentTop:0,parentRight:0,parentBottom:0,singleWidth:200,singleHeight:200,slope:-15,parentSelector:null};function a(t){var r=function(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?n(Object(i),!0).forEach((function(n){e(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},i,{},t),a=null;if(r.parentSelector?(a=document.querySelector(r.parentSelector)).style.position="relative":a=document.body,!document.getElementById(r.id)){var o=document.createElement("canvas"),c=document.createElement("div"),l=o.getContext("2d"),s=r.slope*Math.PI/180;o.id="watermarkCanvasId",o.width=r.singleWidth,o.height=r.singleHeight,l.font="normal ".concat(r.fontSize,"px 'Microsoft Yahei','serif','sans-serif'"),l.fillStyle="rgba(112, 113, 114, ".concat(r.transparency,")"),l.translate(o.width/2,o.height/2),l.rotate(s),l.translate(-o.width/2,-o.height/2),l.textAlign="center";var d=r.fontSize+5,u=Math.ceil(Math.abs(Math.sin(s)*r.singleHeight))+5;!function(t){for(var e=t.str,n=t.ctx,r=t.initX,i=t.initY,a=t.lineHeight,o=t.canvasWidth,c=0,l=0,s=0;s<e.length;s++)(c+=n.measureText(e[s]).width)>o-50&&(n.fillText(e.slice(l,s),r,i),i+=a,c=0,l=s),s==e.length-1&&n.fillText(e.substring(l,s+1),r,i)}({str:r.text,ctx:l,initX:r.singleWidth/2,initY:u,lineHeight:d,canvasWidth:r.singleWidth});var p=o.toDataURL("image/png");c.id=r.id,c.style.position="absolute",c.style.zIndex="9999",c.style.top="".concat(r.parentTop,"px"),c.style.right="".concat(r.parentRight,"px"),c.style.bottom="".concat(r.parentBottom,"px"),c.style.left="".concat(r.parentLeft,"px"),c.style.pointerEvents="none",c.style.backgroundImage="URL("+p+")",a.appendChild(c)}}return t.watermark=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(t),window.addEventListener("resize",(function(){a(t)}));var e=t.id||i.id,n=t.parentSelector||i.parentSelector,o=document.getElementById(e).getAttribute("style"),c=r(n,(function(n,r){n[0].removedNodes[0]&&n[0].removedNodes[0].id===e&&a(t),n[0].target.id===e&&n[0].attributeName&&"style"===n[0].attributeName&&n[0].oldValue!==o&&(n[0].target.style=o)}));c||observeNode.addEventListener("DOMNodeRemoved",(function(){a(t)}),!1)},t}({});
